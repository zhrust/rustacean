# BXMr
> rIME-Squirrel è¡¨å½¢ç ç»´æŠ¤å·¥å…·

## backgroung
ä½œä¸ºä¸€åç¨‹åºçŒ¿, æ€»æ˜¯è¦å¯¹è¾“å…¥æ³•ä¹Ÿè¦æœ‰å…¨é¢æ§åˆ¶

æ‰€ä»¥, ä¸€ç›´æœ‰æŠ˜è…¾:[ZqBXM/Rime-Squirrel at master Â· ZoomQuiet/ZqBXM](https://github.com/ZoomQuiet/ZqBXM/tree/master/Rime-Squirrel)

## goal

å…¨é¢ä½¿ç”¨ Rust é‡æ„åŸæœ‰ Python ç‰ˆæœ¬çš„ç»´æŠ¤æŒ‡ä»¤é›†;


## trace

- æœ€æ—©æ˜¯ æ‰‹å·¥ç»´æŠ¤
- åæ¥ç”¨ Python å†™äº†ä¸ªè„šæœ¬, ä½†æ˜¯è¿˜æ˜¯è¦äººå·¥å¤åˆ¶åˆ°å¯¹åº”ç›®å½•ä¸­å†é‡æ–°ç¼–è¯‘ç è¡¨
- åˆåæ¥, ä½¿ç”¨ invoke æ¡†æ¶æ‹“å±•å¹¶å¢å¼ºäº† BXM ç è¡¨çš„ç»´æŠ¤å†…éƒ¨ç¼–è¾‘
- ç°åœ¨, è½®åˆ° Rust æ¥é‡æ„äº†...


### feeling
> ç»ˆäºæœ‰æ„Ÿè§‰äº†...

çŸ¥é“ Rust æœ‰å¹´å¤´äº†, ä½†æ˜¯, å’Œ golang ç±»ä¼¼, ä¸€ç›´æ²¡æœ‰è®¤çœŸä¸Šæ‰‹,
golang ä¹Ÿå¼€å‘è¿‡å‡ ä¸ªå®ç”¨å°å·¥å…·/ç³»ç»Ÿ, æ„Ÿè§‰å’Œç”¨ Python å·®ä¸å¤š,
è¿˜æ˜¯å¾—é  print ä»¥åŠçº¿ä¸Šäººçœ¼è§‚å¯Ÿ...

Rust å¼€å§‹è¿›å…¥ Linux å†…æ ¸äº†, æ„Ÿè§‰ä¸ä¸€æ ·äº†, è¶³å¤Ÿæ•¦å®äº†,
è€Œä¸”, ä»¥å¾€å¥½è±¡æ‰€æœ‰æŠ˜è…¾è¿‡çš„å¼€å‘è¯­è¨€éƒ½æ˜¯æœ‰ GC çš„...

åœ¨å®Œæˆ [Ferrisè‰ºæœ¯](/dev/cli_ferris_art.md) å°å·¥å…·å,
å†³å®šä»‹å…¥æ—¥å¸¸ç”Ÿæ´», é‡åˆ¶è¿™ä¸ªå®ç”¨å·¥å…·: `BXMr` ~ BXM ç®¡ç†å™¨;
ä»¥ä¾¿æ›¿ä»£åŸå…ˆ Python ç‰ˆæœ¬çš„ -> [tasks.py](https://github.com/ZoomQuiet/ZqBXM/blob/master/Rime-Squirrel/tasks.py)


ä»£ç çš„å¢é•¿, è¦æ±‚å¿…é¡»å¯¹é¡¹ç›®ç›®å½•ç»“æ„è¿›è¡Œè‰¯å¥½çš„è§„åˆ’/æ§åˆ¶/æ¼”å˜/...

è¿›ä¸€æ­¥çš„, åœ¨ä»£ç è°ƒè¯•è¿‡ç¨‹ä¸­, å‘ç°, æœ‰äº† rust-analyzer çš„åŠ æŒ,
ä»¥å¾€çš„å¾ªç¯:

```
    å¼€å‘
    ^   \ 
    |    è¿è¡Œ
    |     \
    |     è§‚å¯Ÿ print()
    |    /
     è°ƒè¯•
```

å¯ä»¥æœ‰è´¨çš„æå‡, ç°åœ¨å¯ä»¥å®Œå…¨ä¿¡ä»»ç¼–è¯‘å™¨äº†,
ç°åœ¨çš„æµç¨‹å˜æˆ:

- æ€è€ƒé—®é¢˜
- æ’°å†™ä»£ç , å®æ—¶æ ¹æ® RA(rust-analyzer) æç¤º, è¿›è¡Œä¿®è®¢
- é‚£ä¹ˆå˜¦åœ¨ IDE ä¸­æ²¡æœ‰è­¦å‘Šæ—¶ 
    - ä¸€èˆ¬ cargo check ä¹Ÿä¸ä¼šæœ‰é—®é¢˜
    - ä»¥åŠ cargo check ä¹Ÿä¸ä¼šæœ‰é—®é¢˜
    - ç”šè‡³ cargo build ä¹Ÿä¸ä¼šæœ‰é—®é¢˜
    - ...ä¹Ÿå°±æ„å‘³ç€æ­¤æ—¶, ä»£ç åŒ…å«çš„æ‰€æœ‰åº”ç”¨/ç³»ç»Ÿè¡Œä¸ºå°±å·²ç»æ˜¯å¯ä¿¡/å¯ç”¨/åšä¸å¯æ‘§çš„äº†
- è¿™ç§é—®é¢˜/ç›®æ ‡/ä»£ç /ç†è§£/... all-in-one çš„æ„Ÿè§‰å¤ªåšå®äº†
    - å¯¹æ¯”ä»¥å¾€å…¶å®ƒè¯­è¨€, å³ä¾¿æ˜¯ IDE/ç¼–è¯‘å™¨ éƒ½æ²¡é—®é¢˜
    - çœŸæ­£è¿è¡Œèµ·æ¥æ—¶, ç…§æ ·æœ‰å„ç§æ„å¤–
    - ...é‚£ç§æ„Ÿè§‰å°±è±¡ å±è±å§† ...è½¯åŸåŸçš„,æƒ³æ€ä¹ˆæŠ˜è…¾å°±æ€ä¹ˆæŠ˜è…¾, å¯å°±æ˜¯æ°¸è¿œå›ºå®šä¸åˆ°ä¸€ä¸ªç†æƒ³çš„çŠ¶æ€
- è€Œ Rust ä¸–ç•Œä¸­,å˜¦ç¼–è¯‘å™¨è¿‡äº†, åŸºæœ¬ä¸Šå°±å¤¯å®äº†...
- å¦‚æœæœ‰é—®é¢˜, åŸºæœ¬ä¸Šå¯ä»¥æ˜ç¡®, ç»å¯¹ä¸æ˜¯ä»£ç é—®é¢˜
    - åªå¯èƒ½æ˜¯è‡ªå·±å¯¹é—®é¢˜çš„ç†è§£æœ‰åå·®
    - ä»¥åŠä»£ç è¡¨è¿°çš„è¡Œä¸ºå’Œæˆ‘ä»¬çš„æœŸå¾…ä¸åŒ...


> å·¥ä½œé‡:


```

à¼„  tokei
===============================================================================
 Language            Files        Lines         Code     Comments       Blanks
===============================================================================
 Markdown                2          218            0          152           66
 Rust                   13         1137          657          322          158
 TOML                    1           51           28           15            8
===============================================================================
 Total                  16         1406          685          489          232
===============================================================================
```

å¯¹æ¯”åŸæœ‰ Python çš„ç‰ˆæœ¬:

```

à¼„  tokei tasks.py
===============================================================================
 Language            Files        Lines         Code     Comments       Blanks
===============================================================================
 Python                  1          248          157           22           69
===============================================================================
 Total                   1          248          157           22           69
===============================================================================
```

å—¯å“¼? æ²¡æœ‰ä¸»è§‚æ„Ÿè§‰çš„10å€, å½“ç„¶,è¿‡ç¨‹ä¸­åˆ é™¤çš„ä¸åŒç‰ˆæœ¬,å¾—æœ‰10å€äº†;


### verb
> çº ç»“æ‰€åœ¨....

åŸé—®é¢˜æ˜¯è¿™æ ·çš„:

- è¾“å…¥æ³•çš„ç è¡¨, åªæ˜¯å°±æ˜¯ä¸€æ‰¹ é”®ç å’Œæ–‡å­— çš„ K/V å€¼å¯¹
- åœ¨ rIME-Squirrel ä¸­åˆ™æ˜¯è¦æ±‚ç»„ç»‡ä¸ºä¸€ä¸ªçº¦å®šçš„ .yaml æ–‡ä»¶
    - æ•°æ®ç»“æ„ä¸º: "{æ–‡å­—}\t{é”®ç }"
    - é”®ç ç›¸åŒæŒ‡å‘å¤šä¸ªæ–‡å­—æ—¶, å°±å¯¹åº”å¤åˆ¶å‡ºæ–°è¡Œæ¥
    - è¡Œçš„å‰åé¡ºåºå†³å®šäº†è¾“å…¥æ—¶æ¨èçš„é¡ºåº
    - æ¯”å¦‚ç°æœ‰å®šä¹‰ç è¡¨è¡Œç‰‡æ®µ:
        - æ•     aaaa
        - å•    aaaa
        - æ•ª    aaaa
        - å¨º    aaaa
        - å•Šå•Šå•Šå•Š    aaaa
    - é‚£ä¹ˆåœ¨ä½¿ç”¨ rIME è¾“å…¥æ—¶è‡ªåŠ¨å¼¹å‡ºçš„æ¨èå­—åˆ—å°±åº”è¯¥æ˜¯:

![aaaa](https://ipic.zoomquiet.top/2023-03-05-zshot%202023-03-05%2021.16.04.jpg)

éš¾ç‚¹åœ¨ `é”®/å­—` æ¡ç›®è¡Œçš„æ¬¡åºæ˜¯æœ‰è¦æ±‚çš„, ä»¥åæ’å…¥æ—¶è¦éµå®ˆ:

- çŸ­é”®ç åœ¨å‰
- ASCII å­—æ¯é¡ºåºä¸ºå…ˆ
- é•¿åº¦ä» 1 åˆ° 4 ä¸ªå­—ç¬¦
- ä¸å¯èƒ½è¶…è¿‡ 4 ä¸ªå­—ç¬¦
- ä¾‹å¦‚:
    - a åœ¨ b ä¹‹å‰
    - a åœ¨ aa ä¹‹å‰
    - aa åœ¨ ab ä¹‹å‰
    - az åœ¨ aaa ä¹‹å‰
    - aaaa åœ¨ b ä¹‹å‰
    - ...
- å¦‚æœå¯¹åº”é”®å¹¶æ²¡å®šåˆ¶å°±ä¸è®°å½•
- ä¾‹å¦‚:
    - åŸæœ‰å®šä¹‰æ¡ç›®è®°å½•:
        - btk æ˜¯ä¸å¹¶
        - btmd æ‚¬è€Œæœªå†³
    - é‚£ä¹ˆ, æƒ³è¿½åŠ ä¸€ä¸ª `btl æ˜¯ä¹Ÿä¹` å°±åº”è¯¥æ’å…¥ä¸º:
        - btk æ˜¯ä¸å¹¶
        - btl æ˜¯ä¹Ÿä¹
        - btmd æ‚¬è€Œæœªå†³
- è¿™é‡Œå°±é—®é¢˜å°±åœ¨ä¸€ä¸ªåŸæœ¬æœ‰å…·ä½“æ’åºè¦æ±‚çš„é”®ç åºåˆ—
    - æœ¬èº«æ˜¯æ®‹ç¼ºçš„
    - è¦åˆ¤å®šæŸä¸ªæ–°å¢é”®ç åº”è¯¥åœ¨å“ªé‡Œæ’å…¥,è¦é¡¾è™‘çš„æ¡ä»¶å¾ˆå¤š
    - ä»¥å¾€éƒ½æ˜¯äººå·¥è§‚å¯Ÿæ’å…¥çš„...è¿˜ä¸å¾—ä¿è¯å¯¹, é‚£æ—¶ rIME ç¼–è¯‘æ—¶å°±æŠ¥é”™...


æ‰€ä»¥, Python ä»£ç å®ç°æ—¶, ç”¨äº†ä¸€ä¸ªåæ¨¡å¼:

- å…ˆæ ¹æ® BXM çš„ç¼–ç è§„åˆ™, æ„é€ å‡ºä¸€ä¸ªä¸¥æ ¼æŒ‰ç…§é”®ç æ’åºçš„ç¼–ç è¡¨
- ç„¶å, å†æ ¹æ®ç°è¡Œä½¿ç”¨çš„ BXM å®šä¹‰ `é”®/å­—` å¡«å†™å…¥è¿™ä¸ªç¼–ç è¡¨
- é‚£ä¹ˆ, è¿›è¡Œç»´æŠ¤æ—¶å°±å˜æˆä¸€ä¸ªç®€å•çš„æŸ¥è¡¨è¿‡ç¨‹:
    - å¯¹åŸæœ‰ `é”®/å­—` çš„æ¡ç›®, è¿½åŠ åŒé”®ä¸åŒå­—æ—¶, è¿½åŠ å­—åˆ°å¯¹åº”çš„é”®åæ•°ç»„å°±å¥½
    - å¯¹åŸå…ˆæ²¡æœ‰çš„æ¡ç›®, åˆ°å¯¹åº”é”®åç©ºç™½æ•°ç»„ä¸­è¿½åŠ å°±å¥½
    - ...
    - æœ€åéœ€è¦æ›´æ–° .yaml æ—¶,  ä»è¿™ä¸ªå…¨ç å…¨åºçš„ç¼–ç è¡¨å¯¹å…¶ä¸­æœ‰æ•ˆçš„æ¡ç›®è¿›è¡Œè½¬æ¢è¾“å‡ºå°±å¥½
- ä¹Ÿå°±æ˜¯è¯´, å°†åŸå…ˆ .yaml ä¸­çš„ "{æ–‡å­—}\t{é”®ç }" å®šä¹‰è®°å½•æ¡ç›®æ–‡æœ¬
    - å…ˆå˜æˆ "{"é”®":["å­—0","å­—1",,]}" ç±»å­—å…¸/HashMap è®°å½•
    - è€Œä¸”,å…¶ä¸­çš„é”®æ˜¯å»åˆ BXM è§„åˆ™çš„å…¨éƒ¨é¡ºåºå¯èƒ½é”®ç 

å¯¹åº”åŸæœ‰ Python ä»£ç :

```python
BXMC = "abcdefghijklmnopqrstuvwxyz"

@task
def init2(c):
    print(f"init from\n\t{ORIG};\nAIM->\t{AIMP}")
    print(f"{AIMP} exists?\n\t",os.path.exists(f"{AIMP}"))
    _gbxm = {}

    def generate_strings(length, prefix=''):
        if length == 0:
            return
        for c in BXMC:
            key = prefix + c
            print(key)
            _gbxm[key] = []
            generate_strings(length-1, key)

    generate_strings(4)
    print(f"gen. all BXM code as {len(_gbxm.keys())}")
    return None
```

å¯¹åº” Rust ç‰ˆæœ¬æ˜¯:

```rust
//  å®šä¹‰åœ¨: src/inv/util.rs
pub const BXMC: &str = "abcdefghijklmnopqrstuvwxyz";
pub const MBCL: usize = 4; // code len.

pub fn generate_strings(length: usize, 
            prefix: String, 
            gbxm: &mut BTreeMap<String, Vec<String>>
        ) {
        if length == 0 {
            return;
        }
        for c in BXMC.chars() {
            let key = prefix.clone() + &c.to_string();
            gbxm.insert(key.clone(), Vec::new());
            generate_strings(length - 1, key, gbxm);
        }
    }

pub fn init2(codelen:usize) -> Option<BTreeMap<String, Vec<String>>> {
    let mut gbxm = BTreeMap::new();
    generate_strings(codelen, String::new(), &mut gbxm);
    //println!("\n\t gen. all BXM code as {} ", gbxm.len());

    Some(gbxm)
}

//  å…·ä½“è°ƒç”¨å½¢å¼:
use crate::inv::util;
...
    let gbxm = util::init2(util::MBCL).unwrap();
```

åŸºæœ¬ä¸Šå’Œ Python ä»£ç  1:1 è½¬æ¢, å½“ç„¶, ä»£ç çš„å¯ä¿¡åº¦è¦é«˜å¾ˆå¤š;

æ¥ä¸‹æ¥æ‰æ˜¯é—®é¢˜:

- ç”Ÿæˆçš„å…¨é‡é”®ç æœ‰ 475,254 ä¸ª
    - ç”¨ toml è®°å½•æ—¶, æœ‰4Mb
- è€Œå¯¹åº” BXM å½“å‰åŒ…å«çš„æ‰€æœ‰é”®ç ä»… 60,337 ä¸ª
    - ç”¨ yaml è®°å½•æ—¶, åªæœ‰ 700Kb
- ç”¨ Python åŠ è½½/æ›´æ–°/å›å†™/... IO æ“ä½œæ—¶,è¦3~4ç§’
- è€Œç”¨ cargo run è¿›è¡Œè¯•ç”¨æ—¶, è¦10ç§’å·¦å³
    - å¥½åœ¨ cargo build --release ä¹‹åçš„äºŒè¿›åˆ¶æ‰§è¡Œæ–‡ä»¶è¿è¡Œæ—¶, å¿«åˆ°äº† 2~3 ç§’
- è¿™æ ·è¿˜æ˜¯æ…¢å“ª....
    - å°è¯•ç”¨å¼‚æ­¥ crate åŠ é€Ÿ, æ•ˆæœä¸æ˜æ˜¾
    - ä»¥å­—æ¯è¡¨ä¸ºåŸºå‡†åˆ‡ä¸º26ä¸ªæ–‡ä»¶? å¤ªéº»çƒ¦è€Œä¸”, è¦åœ¨ç”¨æˆ·æœ¬åœ°ç”Ÿæˆä¸€ç»„æ–‡ä»¶æœ¬èº«ä¹Ÿæ˜¯é—®é¢˜
    - ä¸Š SQLite å†…å­˜æ•°æ®åº“? ç›¸åŒçš„æ•°æ®é‡æƒ³åŠ è½½åˆ°å†…å­˜ä¸­ä¸€æ ·æœ‰è€—æ—¶è¦ç­‰å¾…
    - ....


> è¿˜èƒ½æ€ä¹ˆåŠ é€Ÿå‘¢?

- ä»¥ç°è¡Œæœ‰æ•ˆ `é”®/å­—` å®šä¹‰ä¸ºå‡†, åªç®¡ç†ä¸åˆ°7ä¸‡è¡Œæ•°æ®,æ¯”å°†è¿‘50ä¸‡è¡Œè‚¯å®šè¦å¿«
    - ä½†æ˜¯, è¿™å°±å¾—å®Œæˆå®Œå¤‡çš„æ’å…¥æ¬¡åºåˆ¤å®šç®—æ³•
    - ...å½“ç„¶ä¹Ÿè¡Œ, åªæ˜¯æ²¡å¿…è¦, å¦‚æœ BXMr æƒ³å…¼å®¹æ‰€æœ‰è¾“å…¥æ³•çš„è¯, å°±ä¸èƒ½ç‰¹åŒ–æ”¯æŒç‰¹å®šç è¡¨...
- å›åˆ°é—®é¢˜æºå¤´:
    - æ•°æ®æ–‡ä»¶å¤§, æ‰€ä»¥åŠ è½½æ…¢
    - è€Œä¸”æ²¡ä½¿ç”¨å¤šæ ¸ CPU æ¥åŠ é€Ÿ
    - ...
    - ä¹Ÿå°±æ˜¯è¯´, å€¼å¾—æŠ˜è…¾çš„æ˜¯åˆ©ç”¨ Rust çš„ç³»ç»Ÿç¼–ç¨‹èƒ½åŠ›:
        - æ„é€  `é”®/å­—` å…¨é‡ç è¡¨çš„äºŒè¿›åˆ¶æ–‡ä»¶å½¢å¼, å¤§å¹…å‡å°‘è¦åŠ è½½çš„æ–‡ä»¶å°ºå¯¸
        - åŠ¨ç”¨å¼‚æ­¥/å¹¶å‘/å¹¶è¡Œ/å¤šçº¿ç¨‹/éé˜»å¡/... èƒ½åŠ›, åœ¨æ•°æ®åŠ è½½ä»¥åŠå¤„ç†ä¸ŠåŠ é€Ÿ
    - æ­£å¥½, è¿™ä¹Ÿå°±èƒ½å°†ä»¥å¾€çœ‹çš„èµ„æ–™ä¸­é«˜çº§è¯é¢˜, å¯¹åº”åˆ°å…·ä½“é—®é¢˜éœ€æ±‚ä¸Šæ¥äº†...


### .env
> å¦‚ä½•å¯ä»¥ç¼“å­˜å„ç§å¸¸ç”¨é…ç½®?

å’Œ Python æ—¥å¸¸å¼€å‘å’Œéƒ¨ç½²ä½¿ç”¨ä¸åŒ, ä»¥å¾€:

- ä¸€èˆ¬ä½¿ç”¨ä¸ª _settings.py æ–‡ä»¶,ä½œä¸ºä¸€ä¸ªå…¨å±€å˜é‡æ¡¶, æ”¶é›†å„ç§åœ¨æ‰€æœ‰æ¨¡å—ä¸­éƒ½è¦ç”¨çš„å…³é”®é…ç½®å’Œæ•°æ®
    - åæ­£ä¸€èˆ¬ Python å°å·¥å…·å‘è¡Œæ—¶, å¹¶æ²¡æœ‰ç¼–è¯‘/æ‰“åŒ…çš„è¿‡ç¨‹, éƒ½æ˜¯è„šæœ¬å’Œé…ç½®ä¸€èµ·å‘å¸ƒ
    - å˜¦æ³¨æ„åŠ è½½çš„ç›®å½•å…³ç³», å°±å¯ä»¥æ— è§†æ“ä½œç³»ç»Ÿ, åœ¨ Python è¿è¡Œæ—¶çš„å¸®åŠ©ä¸‹åŠ è½½åˆ°éœ€è¦çš„é…ç½®

ä½†æ˜¯, åœ¨å°è¯•ç”¨ç›¸ä¼¼çš„è¡Œä¸ºå¥—åœ¨ Rust å·¥ç¨‹ä¸­æ‰å›§rz...

- å¦‚æœä¹Ÿæ˜¯ç”¨ _stettings.rs é‚£ä¹ˆç¼–è¯‘å, ä½ç½®å°±ä¸çŸ¥é“äº†, è€Œä¸”ç”¨æˆ·æœ¬åœ°è¦ç°åœºé…ç½®çš„ä¸œè¥¿ä¹Ÿä¸å¯èƒ½å†™å› _settings.rs äº†
- é‚£ä¹ˆ,ä½¿ç”¨ä¸€ä¸ªå¤–éƒ¨çš„ .toml é…ç½®æ–‡ä»¶å‘¢? è¿›è¡Œ cargo build --release å, å‘è¡Œå•ä¸€å¯æ‰§è¡ŒäºŒè¿›åˆ¶ç›®æ ‡æ–‡ä»¶, å’Œå¯¹åº”å†…æ ¸ç³»ç»Ÿé…å¥—çš„, ä¸€èˆ¬å¹¶æ²¡äººæ‹–ä¸€ä¸ª .toml æ¥åˆ°æœ¬åœ°é…ç½®
- å°è¯•å°†å®¢æˆ·çš„é…ç½®ä¿¡æ¯è®°å½•åˆ°ç¯å¢ƒå˜é‡ä¸­, æ‰å‘ç°, æƒ³æ°¸è¿œæœ‰æ•ˆå¿…é¡»å†™å¯¹åº” *rc æ–‡ä»¶, é—®é¢˜æ˜¯ç°åœ¨ bash å¦‚ä¸æ˜¯å¤§ä¸€ç»Ÿ, è¿˜æœ‰å…¶å®ƒæµè¡Œ shell ç‰ˆæœ¬, å¯¹åº”çš„ *rc æ–‡ä»¶æ ¼å¼å’Œä½ç½®ä¹Ÿæ˜¯ä¸å¯é¢„è§çš„...
- è¦ä¸, å˜¦æ¶‰åŠåˆ°å¤–éƒ¨å¯¼å…¥/å¯¼å‡ºçš„æ¥æºå’Œå‘å¸ƒç›®æ ‡æ–‡ä»¶, è¦æ±‚æ¯æ¬¡æŒ‡ä»¤ç”¨æˆ·è‡ªå·±é€šè¿‡é™„åŠ å‚æ•°ç»™å‡ºæ¥å°±å¥½?
    - å›æƒ³è‡ªå·±ä½¿ç”¨å°±è¿‡ç¨‹, æ¯æ¬¡æ— è®ºä»€ä¹ˆæŒ‡ä»¤, éƒ½è¦è·Ÿä¸Š 1~2 ä¸ª, æˆ–æ˜¯æ›´å¤šè·¯å¾„å‚æ•°....è´¥é€€...
- ...çªç„¶æƒ³åˆ°è¿˜æœ‰ä¸ª `.env` æ–‡ä»¶å“ª...ç®—æ˜¯åº”ç”¨ç³»ç»Ÿçš„éšèº«è¿è¡Œæ—¶ç¯å¢ƒå˜é‡,æœ¬èº«å¾ˆç®€å•å¯ä»¥è§†ä¸ºç®€åŒ–ç‰ˆæœ¬çš„ .ini æ–‡ä»¶
- è¿½æŸ¥äº†ä¸€ä¸‹æœç„¶æœ‰ [dotenv - crates.io: Rust Package Registry](https://crates.io/crates/dotenv/0.15.0)
    - é‚£ä¹ˆé€»è¾‘å°±ç®€å•äº†:
    - æ— è®ºç”¨å“ªä¸ªæŒ‡ä»¤, å…ˆæ£€éªŒå›ºå®šçš„å’Œæ‰§è¡Œæ–‡ä»¶åŒç›®å½•çš„ .env æ–‡ä»¶
    - å¦‚æœæ²¡æœ‰, æŒ‡å¼•ç”¨æˆ·å…ˆç”¨ `$ bxmr cfg ...` æŒ‡ä»¤æ¥å®Œæˆå…³é”®æ–‡ä»¶çš„æŒ‡å¼•
    - ç„¶å, å†™å…¥ .env æ–‡ä»¶ä¸­, å¹¶è‡ªåŠ¨åŠ è½½åˆ°ç¯å¢ƒå˜é‡é‡Œ
    - è¿™æ ·, å˜¦è¿è¡Œè‡ªå·±å·¥å…·çš„å‘è¡Œç‰ˆ, å°±å¯ä»¥ä»æœ¬èº«æ‰€åœ¨ç›®å½•ä¸­åŠ è½½åˆ°ä»¥å¾€çš„å…³é”®é…ç½®, ç”¨åœ¨å…·ä½“æŒ‡ä»¤å“åº”è¿‡ç¨‹ä¸­...



### async
> åªæ˜¯æƒ³åŠ é€Ÿä¸€ä¸ªæ–‡ä»¶çš„è¯»å–...

-> [æ–‡ä»¶åŠ é€Ÿæ‰“å¼€](/tip/open_big_file_speed.md)

ç„¶åå°±å‘ç°,è¿™äº‹å„¿æ²¡é‚£ä¹ˆç®€å•, æ•´ä½“ä¸Š:

> éœ€è¦æ˜ç¡®çš„æ˜¯ï¼Œasyncå‡½æ•°åœ¨Rustä¸­æ˜¯ä¸€ç§ç‰¹æ®Šçš„å‡½æ•°ç±»å‹ï¼Œå¯ä»¥åœ¨å…¶ä¸­ä½¿ç”¨awaitæ“ä½œç¬¦ç­‰å¼‚æ­¥æ“ä½œï¼Œè€Œasyncå‡½æ•°çš„è¿”å›ç±»å‹æ˜¯ä¸€ä¸ªå®ç°äº†Future traitçš„ç±»å‹ï¼Œè¿™ä¸ªç±»å‹åœ¨ç¼–è¯‘æ—¶æ˜¯ä¸ç¡®å®šçš„ï¼Œå› ä¸ºå®ƒè¡¨ç¤ºä¸€ä¸ªå¼‚æ­¥è®¡ç®—çš„ç»“æœï¼Œéœ€è¦ç­‰å¾…æ‰§è¡Œå®Œæˆæ‰èƒ½å¾—åˆ°å…·ä½“çš„ç»“æœç±»å‹ã€‚å› æ­¤ï¼Œå½“ä½ è°ƒç”¨ä¸€ä¸ªasyncå‡½æ•°æ—¶ï¼Œä½ éœ€è¦åœ¨ä¸€ä¸ªasyncä¸Šä¸‹æ–‡ä¸­ï¼Œä¾‹å¦‚åœ¨asyncå‡½æ•°ä¸­æˆ–è€…ä½¿ç”¨tokioç­‰å¼‚æ­¥è¿è¡Œæ—¶åº“çš„Runtimeæ¥è¿è¡Œå¼‚æ­¥ä»»åŠ¡ã€‚

æ‰€ä»¥, åŸæœ‰çš„è°ƒç”¨æ ˆ:

- src/main.rs -> fn main() 
    - inv::run() -> src/inv.rs 
        - seek::echo() -> src/inv/seek.rs
            - util::toml2btmap() -> src/inv/util.rs
                - file.read_to_string(&mut contents).unwrap()
                    - let mut file = File::open(tfile).unwrap()
- å‘ç°å¯ä»¥ç”¨ tokio å®ç°å¼‚æ­¥æ“ä½œ, å¹¶åŠ é€Ÿæ–‡ä»¶è¯»å–?
    - äºæ˜¯-> 
        - use tokio::fs::File as TokioFile;
        - use tokio::io::BufReader as TokioBufReader;
    - ç„¶å-> 
        - let file = TokioFile::open(path).await?;
        - let reader = TokioBufReader::new(file);
    - ä½†æ˜¯, å‘ç°ä¸è¡Œ, await? ä¸èƒ½ç¼–è¯‘, å› ä¸ºæ‰€åœ¨å‡½æ•°ä¸æ˜¯ async çš„, äºæ˜¯è¿é”ååº”
    - pub async fn async_read_lines().await <- ä»¥ä¾¿è¢«è°ƒç”¨
        - pub async fn async_toml2btmap() <- ä»¥ä¾¿è¢«è°ƒç”¨
            - util::async_toml2btmap().await <- src/inv/util.rs
                - async fn seek::echo().await <- src/inv/seek.rs
                    - async fn run() <- src/inv.rs 
                        - inv::run().await <- src/main.rs
                            - async fn main()


å¦‚æœä¸æ˜¯ rust-analyzer ä¸€è·¯æé†’, çœŸä¼šè’™åœˆå„¿çš„...



## refer.

- [clap::_derive::_cookbook::git_derive - Rust](https://docs.rs/clap/latest/clap/_derive/_cookbook/git_derive/index.html)
    - ç®€åŒ–å®˜æ–¹ç¤ºä¾‹,å®Œæˆç»“æ„æ€§æ¢ç´¢
- [Building a CLI from scratch with Clapv3 | by Ukpai Ugochi | Medium](https://medium.com/javascript-in-plain-english/coding-wont-exist-in-5-years-this-is-why-6da748ba676c)
    - å¾ˆå›§çš„æ¡ˆä¾‹, çœ‹èµ·æ¥å¾ˆç¾å´æ ¹æœ¬ç¼–è¯‘ä¸è¿‡...
- å°´å°¬äº†, äºŒè¿›åˆ¶å‘è¡Œç‰ˆæœ¬çš„åº”ç”¨å¯æ²¡æœ‰é‚£ä¹ˆç®€å•çš„å…¨å±€é…ç½®å¯ä»¥ä½¿ç”¨...
    - [Working with Environment Variables in Rust Â· Thorsten Hans' blog](https://www.thorsten-hans.com/working-with-environment-variables-in-rust/)
    - ...
- ...

## logging

- ...
- 230301 ZQ ...ğŸ¦€
- 230227 ZQ mod/clap/tracing/... é¡¹ç›®ç»“æ„å˜å®š
- 230225 ZQ re-re-re-init.





```
        _~^|âˆ½~_
    \) /  â—´ â˜‰  \ \/
      '_   âµ   _'
      / '--âˆ½--' \

...act by ferris-actor v0.2.4 (built on 23.0303.201916)
```



